<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Change Background â€¢ AI Photo Studio</title>

<link href="styles.css" rel="stylesheet">

<style>
    body {
        margin:0;
        background:#0b0f1c;
        font-family:Inter, system-ui, sans-serif;
        color:white;
    }

    .topbar {
        height:70px;
        background:#111827;
        border-bottom:1px solid #1f2937;
        display:flex;
        align-items:center;
        padding:0 20px;
        gap:15px;
    }

    .topbar img {
        width:34px;
        height:34px;
    }

    .topbar h2 {
        font-size:20px;
        font-weight:700;
        margin:0;
        color:#3fb7ff;
    }

    .container {
        padding:20px;
        max-width:900px;
        margin:auto;
    }

    .section-title {
        font-size:22px;
        margin:20px 0 10px;
        font-weight:700;
    }

    .upload-box {
        border:2px dashed #3fb7ff44;
        border-radius:16px;
        padding:40px;
        text-align:center;
        cursor:pointer;
        margin-bottom:30px;
        background:#111827;
    }

    .upload-box:hover {
        background:#1b2538;
    }

    .upload-box p {
        opacity:0.8;
    }

    #mainImagePreview {
        width:100%;
        border-radius:12px;
        margin-bottom:25px;
        display:none;
    }

    .bg-grid {
        display:grid;
        grid-template-columns:repeat(auto-fit, minmax(120px, 1fr));
        gap:15px;
    }

    .bg-item {
        height:90px;
        border-radius:12px;
        background-size:cover;
        background-position:center;
        cursor:pointer;
        border:2px solid #1f2937;
        transition:0.15s;
    }

    .bg-item:hover {
        border-color:#3fb7ff;
        transform:scale(1.03);
    }

    .apply-btn {
        width:100%;
        background:#3fb7ff;
        padding:14px;
        border:none;
        border-radius:12px;
        font-size:18px;
        font-weight:700;
        cursor:pointer;
        margin-top:25px;
    }
</style>

<script>
let selectedMainImage = null;
let selectedBackground = null;

// Upload main photo
function uploadMain() {
    document.getElementById("mainUpload").click();
}

document.getElementById("mainUpload")?.addEventListener("change", (e) => {
    const file = e.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = () => {
        selectedMainImage = reader.result;
        const preview = document.getElementById("mainImagePreview");
        preview.src = selectedMainImage;
        preview.style.display = "block";
    };
    reader.readAsDataURL(file);
});

// Upload custom background
function uploadBG() {
    document.getElementById("bgUpload").click();
}

document.getElementById("bgUpload")?.addEventListener("change", (e) => {
    const file = e.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = () => {
        selectedBackground = reader.result;
        applyBackground(selectedBackground);
    };
    reader.readAsDataURL(file);
});

// Choose preset background
function choosePreset(url) {
    selectedBackground = url;
    applyBackground(url);
}

// Save for final editor
function applyBackground(bg) {
    if (!selectedMainImage) return alert("Upload your main photo first!");
    localStorage.setItem("selectedMainImage", selectedMainImage);
    localStorage.setItem("selectedBackground", bg);
    window.location.href = "/editor-output.html";
}
</script>

</head>
<body>

<div class="topbar">
    <img src="/icons/icon-change-background.png">
    <h2>Change Background</h2>
</div>

<div class="container">

    <h3 class="section-title">1. Upload Your Photo</h3>

    <div class="upload-box" onclick="uploadMain()">
        <p>Click to upload your main image</p>
        <input type="file" id="mainUpload" accept="image/*" hidden>
    </div>

    <img id="mainImagePreview">

    <h3 class="section-title">2. Choose a New Background</h3>

    <div class="upload-box" onclick="uploadBG()">
        <p>Upload Your Own Background</p>
        <input type="file" id="bgUpload" accept="image/*" hidden>
    </div>

    <h3 class="section-title">Or Pick a Preset</h3>

    <div class="bg-grid">
        <div class="bg-item" style="background-image:url('/stock/bg1.jpg')" onclick="choosePreset('/stock/bg1.jpg')"></div>
        <div class="bg-item" style="background-image:url('/stock/bg2.jpg')" onclick="choosePreset('/stock/bg2.jpg')"></div>
        <div class="bg-item" style="background-image:url('/stock/bg3.jpg')" onclick="choosePreset('/stock/bg3.jpg')"></div>
        <div class="bg-item" style="background-image:url('/stock/bg4.jpg')" onclick="choosePreset('/stock/bg4.jpg')"></div>
    </div>

</div>

</body>
</html>
